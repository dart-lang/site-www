{"success":true,"payload":{"value":{"id":"6bd3121772de","versionId":"83b7a4f5cf24","creatorId":"7c51fc1918ba","homeCollectionId":"23738d481ce8","title":"Dart gets a Type System","detectedLanguage":"en","latestVersion":"83b7a4f5cf24","latestPublishedVersion":"83b7a4f5cf24","hasUnpublishedEdits":false,"latestRev":1117,"createdAt":1499094469784,"updatedAt":1528792461159,"acceptedAt":0,"firstPublishedAt":1499188322094,"latestPublishedAt":1499192799523,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"Rejoice, all ye faithful, for Dart 2.0 is coming, and it has types.","bodyModel":{"paragraphs":[{"name":"c885","type":3,"text":"Dart gets a Type System","markups":[]},{"name":"f7cf","type":1,"text":"Rejoice, all ye faithful, for Dart 2.0 is coming, and it has types.","markups":[{"type":3,"start":57,"end":66,"href":"http://news.dartlang.org/2017/06/a-stronger-dart-for-everyone.html","title":"","rel":"","anchorType":0}]},{"name":"9202","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*C4V5HBaOprKmpRUh.","originalWidth":940,"originalHeight":627}},{"name":"e34a","type":1,"text":"This is Dart’s first major breaking change — hence the “2” — and it’s precisely because it’s a breaking change that it’s such an important development. Let’s dig into why that is. First, some Dart 1 code:","markups":[{"type":2,"start":80,"end":87}]},{"name":"90be","type":8,"text":"void main() {\n  cleanUp([new TempFile(), new BankAccount()]);\n}","markups":[]},{"name":"e008","type":8,"text":"void cleanUp(List<TempFile> files) =>\n    files.forEach((f) => f.delete());","markups":[]},{"name":"0074","type":8,"text":"class TempFile {\n  void delete() => print('TempFile deleted.');\n}","markups":[]},{"name":"f01d","type":8,"text":"class BankAccount {\n  void delete() => print('BankAccount deleted. Whoops!');\n}","markups":[]},{"name":"cfd8","type":8,"text":"> TempFile deleted.\n> BankAccount deleted. Whoops!","markups":[]},{"name":"bda4","type":1,"text":"The code is a little surprising.","markups":[]},{"name":"cf2f","type":1,"text":"Both “TempFile” and “BankAccount” have a “delete” method; it so happens that since Dart 1 does not, by default, care about types, it will happily let us call “delete” on a “BankAccount” when we were very clearly trying to call “delete” on a “TempFile”.","markups":[]},{"name":"7efc","type":1,"text":"Not good.","markups":[]},{"name":"a9ac","type":3,"text":"Strong Mode Analysis","markups":[]},{"name":"ccd0","type":1,"text":"Enter Strong Mode, the new type system for Dart. (We won’t need the name once Dart 2.0 arrives; it’ll just be “the type system”).","markups":[]},{"name":"d119","type":1,"text":"The Dart analyzer has supported Strong Mode static analysis for some time; it uses type inference to work out what types you most likely meant, and requires that each variable can only have a single type. It also adds strictness around overrides and generics.","markups":[{"type":3,"start":4,"end":17,"href":"https://github.com/dart-lang/sdk/tree/master/pkg/analyzer_cli","title":"","rel":"","anchorType":0}]},{"name":"b163","type":1,"text":"If we feed the code snippet above to the analyzer with Strong Mode enabled, it tells us:","markups":[]},{"name":"44d4","type":8,"text":"error: The element type 'BankAccount' can't be assigned to the list type 'TempFile'.","markups":[]},{"name":"32ee","type":1,"text":"…which seems reasonable. Problem solved. Or is it?","markups":[]},{"name":"4b57","type":1,"text":"Unfortunately not. There are a few ways to trick static analysis. For example, we can use “new List.from”, which takes any “Iterable”:","markups":[]},{"name":"7755","type":8,"text":"void main() {\n  var list = new List<TempFile>.from(\n      [new TempFile(), new BankAccount()]);\n  cleanUp(list);\n}","markups":[]},{"name":"a7ab","type":8,"text":"> TempFile deleted.\n> BankAccount deleted. Whoops!","markups":[]},{"name":"3bb7","type":1,"text":"…and the analyzer is powerless to help. There is simply no way to catch this problem with static checks.","markups":[]},{"name":"aec9","type":3,"text":"Strong Mode Proper","markups":[]},{"name":"5192","type":1,"text":"Here we approach the concept of soundness; whether the type system is able to deliver on what it promises. Extra static checks via the analyzer help catch bugs, but they’re not enough to close all the holes. What’s needed is some additional runtime checks.","markups":[]},{"name":"fade","type":1,"text":"There is currently only one Dart runtime that implements those checks; the Dart Dev Compiler (DDC). If we run that last snippet with DDC we get a runtime error:","markups":[{"type":3,"start":75,"end":98,"href":"https://github.com/dart-lang/sdk/tree/master/pkg/dev_compiler","title":"","rel":"","anchorType":0}]},{"name":"710c","type":8,"text":"Type 'BankAccount' is not a subtype of type 'TempFile'","markups":[]},{"name":"00e3","type":1,"text":"So, our bank account is safe. Strong Mode with runtime checks guarantees that if we are trying to run “TempFile.delete” we will never, under any circumstances[1], run “BankAccount.delete” instead.","markups":[]},{"name":"411b","type":3,"text":"Dart 2.0","markups":[]},{"name":"a841","type":1,"text":"And here we return to the announcement about Dart 2.0, and why it’s important.","markups":[]},{"name":"b1de","type":1,"text":"The reason DDC is the only runtime to add these checks is that they are breaking changes to the language. Programs that used to be valid are no longer valid. DDC is a development tool, so it doesn’t need to compile and run all valid Dart; the VM and dart2js do.","markups":[]},{"name":"d79b","type":1,"text":"So with the change to Dart 2.0, those programs with type problems can now be declared invalid — and all the runtimes can move on to providing types that do what they promise. A happy ending, and an important step for my favourite programming language.","markups":[]},{"name":"7190","type":3,"text":"Aside: And Nothing of Value was Lost","markups":[]},{"name":"b8a8","type":1,"text":"It’s natural to ask about the downsides of the change. What if we want loose types from Dart?","markups":[{"type":2,"start":30,"end":39},{"type":2,"start":66,"end":71}]},{"name":"786a","type":1,"text":"Fortunately the language has that covered. We can always opt out of type checks with the special “dynamic” type. In fact, “dynamic” is the default if you don’t add a type annotation, so we could just have written “List” instead of “List<TempFile>”:","markups":[]},{"name":"45c2","type":8,"text":"void main() {\n  cleanUp([new TempFile(), new BankAccount()]);\n}\n\nvoid cleanUp(List files) =>\n    files.forEach((f) => f.delete());\n\nclass TempFile {\n  void delete() => print('TempFile deleted.');\n}\n\nclass BankAccount {\n  void delete() => print('BankAccount deleted. Whoops!');\n}","markups":[]},{"name":"8079","type":8,"text":"> TempFile deleted.\n> BankAccount deleted. Whoops!","markups":[]},{"name":"639f","type":1,"text":"…and we have perfectly valid Dart 2.0 code[2]. The “cleanUp” method is now written to work on any class with a “delete” method — and that’s exactly what it does.","markups":[{"type":2,"start":94,"end":97}]},{"name":"b7af","type":1,"text":"[1] As other languages have shown, getting a type system 100% sound is hard. But there won’t be any known ways of breaking the type system.","markups":[{"type":3,"start":23,"end":33,"href":"https://dev.to/rosstate/java-is-unsound-the-industry-perspective","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":100},{"type":2,"start":105,"end":139}]},{"name":"7fa5","type":1,"text":"[2] Dart 2.0 doesn’t exist yet, so this isn’t 100% guaranteed. But as far as the types go, this should be fine.","markups":[{"type":2,"start":0,"end":111}]}],"sections":[{"name":"4604","startIndex":0},{"name":"558e","startIndex":31}]},"postDisplay":{"coverless":true}},"virtuals":{"statusForCollection":"APPROVED","allowNotes":true,"previewImage":{"imageId":"0*C4V5HBaOprKmpRUh.","filter":"","backgroundSize":"","originalWidth":940,"originalHeight":627,"strategy":"resample","height":0,"width":0},"wordCount":731,"imageCount":1,"readingTime":2.958490566037736,"subtitle":"Rejoice, all ye faithful, for Dart 2.0 is coming, and it has types.","userPostRelation":{"userId":"8b6a7f6f197d","postId":"6bd3121772de","readAt":0,"readLaterAddedAt":0,"votedAt":0,"collaboratorAddedAt":0,"notesAddedAt":0,"subscribedAt":0,"lastReadSectionName":"","lastReadVersionId":"","lastReadAt":0,"lastReadParagraphName":"","lastReadPercentage":0,"viewedAt":0,"presentedCountInResponseManagement":0,"clapCount":0,"seriesUpdateNotifsOptedInAt":0,"queuedAt":0,"seriesFirstViewedAt":0,"presentedCountInStream":2,"seriesLastViewedAt":0,"audioProgressSec":0},"publishedInCount":1,"usersBySocialRecommends":[],"noIndex":false,"recommends":63,"isBookmarked":false,"tags":[{"slug":"programming","name":"Programming","postCount":400575,"metadata":{"postCount":400575,"coverImage":{"id":"0*7x-LQAg1xBmi-L1p","originalWidth":1800,"originalHeight":1169,"alt":"Screenshot of a desktop with the Cursor application open"}},"type":"Tag"},{"slug":"dartlang","name":"Dartlang","postCount":921,"metadata":{"postCount":921,"coverImage":{"id":"1*HNqQFQ2hdhAgjew1pIMqXA.png","originalWidth":2752,"originalHeight":1536,"isFeatured":true}},"type":"Tag"},{"slug":"dart","name":"Dart","postCount":13858,"metadata":{"postCount":13858,"coverImage":{"id":"1*rQugDrmwFFsEDL_CqSBJNw.png","originalWidth":1536,"originalHeight":1024,"isFeatured":true}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":2,"links":{"entries":[{"url":"https://dev.to/rosstate/java-is-unsound-the-industry-perspective","alts":[],"httpStatus":200},{"url":"http://news.dartlang.org/2017/06/a-stronger-dart-for-everyone.html","alts":[],"httpStatus":200},{"url":"https://github.com/dart-lang/sdk/tree/master/pkg/analyzer_cli","alts":[],"httpStatus":200},{"url":"https://github.com/dart-lang/sdk/tree/master/pkg/dev_compiler","alts":[],"httpStatus":200}],"version":"0.3","generatedAt":1499192800065},"isLockedPreviewOnly":false,"metaDescription":"","totalClapCount":187,"sectionCount":2,"readingList":0,"topics":[]},"coverless":true,"slug":"dart-gets-a-type-system","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":true,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"dart-gets-a-type-system-6bd3121772de","previewContent":{"bodyModel":{"paragraphs":[{"name":"c885","type":3,"text":"Dart gets a Type System","markups":[],"alignment":1},{"name":"f7cf","type":1,"text":"Rejoice, all ye faithful, for Dart 2.0 is coming, and it has types.","markups":[{"type":3,"start":57,"end":66,"href":"http://news.dartlang.org/2017/06/a-stronger-dart-for-everyone.html","title":"","rel":"","anchorType":0}],"alignment":1},{"name":"9202","type":4,"text":"","markups":[],"layout":9,"metadata":{"id":"0*C4V5HBaOprKmpRUh.","originalWidth":940,"originalHeight":627}}],"sections":[{"startIndex":0}]},"isFullContent":false,"subtitle":"Rejoice, all ye faithful, for Dart 2.0 is coming, and it has types."},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://blog.dart.dev/dart-gets-a-type-system-6bd3121772de","approvedHomeCollectionId":"23738d481ce8","isNewsletter":false,"newsletterId":"","webCanonicalUrl":"https://blog.dart.dev/dart-gets-a-type-system-6bd3121772de","mediumUrl":"https://blog.dart.dev/dart-gets-a-type-system-6bd3121772de","migrationId":"","notifyFollowers":true,"notifyTwitter":true,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isEligibleForRevenue":false,"isBlockedFromHightower":false,"deletedAt":0,"lockedPostSource":0,"hightowerMinimumGuaranteeStartsAt":0,"hightowerMinimumGuaranteeEndsAt":0,"featureLockRequestAcceptedAt":0,"mongerRequestType":1,"layerCake":0,"socialTitle":"","socialDek":"","editorialPreviewTitle":"","editorialPreviewDek":"","curationEligibleAt":0,"isProxyPost":false,"proxyPostFaviconUrl":"","proxyPostProviderName":"","proxyPostType":0,"isSuspended":false,"isLimitedState":false,"seoTitle":"","previewContent2":{"bodyModel":{"paragraphs":[{"name":"c885","type":3,"text":"Dart gets a Type System","markups":[]},{"name":"f7cf","type":1,"text":"Rejoice, all ye faithful, for Dart 2.0 is coming, and it has types.","markups":[{"type":3,"start":57,"end":66,"href":"http://news.dartlang.org/2017/06/a-stronger-dart-for-everyone.html","title":"","rel":"","anchorType":0}]},{"name":"9202","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*C4V5HBaOprKmpRUh.","originalWidth":940,"originalHeight":627}},{"name":"e34a","type":1,"text":"This is Dart’s first major breaking change — hence the “2” — and it’s precisely because it’s a breaking change that it’s such an important development. Let’s dig into why that is. First, some Dart 1 code:","markups":[{"type":2,"start":80,"end":87}]},{"name":"90be","type":8,"text":"…","markups":[]}],"sections":[{"name":"4604","startIndex":0}]},"isFullContent":false,"subtitle":"Rejoice, all ye faithful, for Dart 2.0 is coming, and it has types."},"cardType":0,"isDistributionAlertDismissed":false,"isShortform":false,"shortformType":0,"responsesLocked":false,"isLockedResponse":false,"isPublishToEmail":false,"responseDistribution":0,"isMarkedPaywallOnly":false,"type":"Post"},"mentionedUsers":[],"collaborators":[],"hideMeter":false,"shareKey":"ca34fe612bd5708dc14f0c8f50a27353","collectionUserRelations":[{"collectionId":"23738d481ce8","userId":"8b6a7f6f197d","role":"ADMIN"},{"collectionId":"4da7dfd21a33","userId":"8b6a7f6f197d","role":"WRITER"},{"collectionId":"24d8f4fa8912","userId":"8b6a7f6f197d","role":"WRITER"}],"mode":"canEdit","references":{"User":{"7c51fc1918ba":{"userId":"7c51fc1918ba","name":"David Morgan","username":"davidmorgan_14314","createdAt":1479905471772,"imageId":"0*CyTzB0Ea4W-QND7p.","backgroundImageId":"","bio":"Software Engineer at Google; works on Dart.","twitterScreenName":"__davidmorgan__","socialStats":{"userId":"7c51fc1918ba","usersFollowedCount":68,"usersFollowedByCount":1571,"type":"SocialStats"},"social":{"userId":"8b6a7f6f197d","targetUserId":"7c51fc1918ba","type":"Social"},"allowNotes":1,"mediumMemberAt":0,"isWriterProgramEnrolled":true,"isSuspended":false,"isMembershipTrialEligible":true,"facebookDisplayName":"","optInToIceland":true,"hasCompletedProfile":false,"userDismissableFlags":[1],"hasSeenIcelandOnboarding":false,"postSubscribeMembershipUpsellShownAt":0,"languageCode":"en-us","type":"User"}},"Collection":{"23738d481ce8":{"id":"23738d481ce8","name":"Dart","slug":"dartlang","tags":["MOBILE APP DEVELOPMENT","WEB DEVELOPMENT","DART","PROGRAMMING LANGUAGES","SOFTWARE DEVELOPMENT"],"creatorId":"a6d788faa5e5","description":"Dart is an approachable, portable, and productive language for high-quality apps on any platform. Learn more at https://dart.dev.","shortDescription":"Dart is an approachable, portable, and productive language…","image":{"imageId":"1*uWy1Ajpd0oTUQBO9WBHoQg@2x.png","filter":"","backgroundSize":"","originalWidth":1001,"originalHeight":1001,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":14031,"activeAt":1762974121956},"virtuals":{"permissions":{"canPublish":true,"canPublishAll":true,"canRepublish":true,"canRemove":true,"canManageAll":true,"canSubmit":true,"canEditPosts":true,"canAddWriters":true,"canViewStats":true,"canSendNewsletter":true,"canViewLockedPosts":true,"canViewCloaked":true,"canEditOwnPosts":true,"canBeAssignedAuthor":true,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false,"canLockOwnPostsForMediumMembers":false,"canViewNewsletterV2Stats":true,"canCreateNewsletterV3":true},"isSubscribed":true,"isEnrolledInHightower":false,"isEligibleForHightower":false,"isSubscribedToCollectionEmails":false,"isMuted":false,"canToggleEmail":false,"isWriter":false},"logo":{"imageId":"1*NRb7RFVWJQFzY47j3v4U7Q.png","filter":"","backgroundSize":"","originalWidth":400,"originalHeight":154,"strategy":"resample","height":0,"width":0},"twitterUsername":"dart_lang","publicEmail":"medium@dartlang.org","domain":"blog.dart.dev","sections":[{"type":2,"collectionHeaderMetadata":{"title":"Dart","description":"An approachable, portable, and productive language for high-quality apps on any platform","backgroundImage":{},"logoImage":{"id":"1*knHF_qpxdtS8h0Z8EeqowA@2x.png","originalWidth":1080,"originalHeight":1080,"alt":"Dart"},"alignment":2,"layout":5}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":7,"postIds":[]}},{"type":1,"postListMetadata":{"source":1,"layout":5,"number":15,"postIds":[]}}],"tintColor":"#FF042B59","lightText":true,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF6588BA","point":0},{"color":"#FF607EAB","point":0.1},{"color":"#FF59759C","point":0.2},{"color":"#FF536B8E","point":0.3},{"color":"#FF4C617F","point":0.4},{"color":"#FF445670","point":0.5},{"color":"#FF3D4B61","point":0.6},{"color":"#FF344052","point":0.7},{"color":"#FF2B3442","point":0.8},{"color":"#FF212832","point":0.9},{"color":"#FF161A22","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FF042B59","point":0},{"color":"#FF294871","point":0.1},{"color":"#FF456087","point":0.2},{"color":"#FF5F779B","point":0.3},{"color":"#FF788DAD","point":0.4},{"color":"#FF8FA2BF","point":0.5},{"color":"#FFA5B6CF","point":0.6},{"color":"#FFBBC9DF","point":0.7},{"color":"#FFD1DCEE","point":0.8},{"color":"#FFE6EEFC","point":0.9},{"color":"#FFFBFFFF","point":1}],"backgroundColor":"#FF042B59"},"highlightSpectrum":{"colorPoints":[{"color":"#FFECF3FF","point":0},{"color":"#FFE9F2FF","point":0.1},{"color":"#FFE5F0FF","point":0.2},{"color":"#FFE2EFFF","point":0.3},{"color":"#FFDEEDFF","point":0.4},{"color":"#FFDBEBFF","point":0.5},{"color":"#FFD7EAFF","point":0.6},{"color":"#FFD3E8FF","point":0.7},{"color":"#FFCFE6FF","point":0.8},{"color":"#FFCBE5FF","point":0.9},{"color":"#FFC8E3FF","point":1}],"backgroundColor":"#FFFFFFFF"},"darkBackgroundSpectrum":{"colorPoints":[{"color":"#FF7DA0D3","point":0},{"color":"#FF89A9D8","point":0.1},{"color":"#FF94B1DC","point":0.2},{"color":"#FFA0B9E0","point":0.3},{"color":"#FFABC1E3","point":0.4},{"color":"#FFB6C9E7","point":0.5},{"color":"#FFC0D1EB","point":0.6},{"color":"#FFCBD8EF","point":0.7},{"color":"#FFD5E0F2","point":0.8},{"color":"#FFE0E7F6","point":0.9},{"color":"#FFEAEFFA","point":1}],"backgroundColor":"#FF000000"}},"navItems":[{"type":1,"title":"Announcements","tagSlug":"announcements","url":"https://blog.dart.dev/tagged/announcements","source":"tagSlug"},{"type":5,"title":"Archive","url":"https://blog.dart.dev/archive"},{"type":3,"title":"dart.dev","url":"https://dart.dev"}],"colorBehavior":2,"collectionFeatures":[25],"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"Dart","description":"An approachable, portable, and productive language for high-quality apps on any platform","backgroundImage":{},"logoImage":{"id":"1*knHF_qpxdtS8h0Z8EeqowA@2x.png","originalWidth":1080,"originalHeight":1080,"alt":"Dart"},"alignment":2,"layout":5},"subscriberCount":14031,"tagline":"Dart is a client-optimized language for fast apps on any platform.","isOptedIntoAurora":false,"isCurationAllowedByDefault":false,"polarisCoverImage":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"ptsQualifiedAt":1616092887098,"type":"Collection"}},"Social":{"7c51fc1918ba":{"userId":"8b6a7f6f197d","targetUserId":"7c51fc1918ba","type":"Social"}},"SocialStats":{"7c51fc1918ba":{"userId":"7c51fc1918ba","usersFollowedCount":68,"usersFollowedByCount":1571,"type":"SocialStats"}}}},"v":3,"b":"20260130-1012-root"}