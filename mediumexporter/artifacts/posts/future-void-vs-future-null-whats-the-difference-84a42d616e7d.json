{"success":true,"payload":{"value":{"id":"84a42d616e7d","versionId":"ae77af47ef5f","creatorId":"c9094de7d9b1","homeCollectionId":"23738d481ce8","title":"Future<void> vs Future<Null>, what’s the difference?","detectedLanguage":"en","latestVersion":"ae77af47ef5f","latestPublishedVersion":"ae77af47ef5f","hasUnpublishedEdits":false,"latestRev":588,"createdAt":1540917508178,"updatedAt":1540920383253,"acceptedAt":0,"firstPublishedAt":1540920382755,"latestPublishedAt":1540920382755,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"One of the nice upgrades we were able to do in Dart 2 (in addition to better static checking, runtime type safety, optional new/const…","bodyModel":{"paragraphs":[{"name":"ef07","type":3,"text":"Future<void> vs Future<Null>, what’s the difference?","markups":[]},{"name":"59d5","type":1,"text":"One of the nice upgrades we were able to do in Dart 2 (in addition to better static checking, runtime type safety, optional new/const, core library improvements, and more) is to formalize void in a way that’s both more useful and less error-prone. This is especially clean in async programming where you can write Future<void> for asynchronous functions that don’t return an answer when their work completes. Before this you probably used Future<Null>, so common questions we get asked are: What’s the difference between Future<void> and Future<Null>? Which should I use, and when?","markups":[{"type":10,"start":188,"end":192},{"type":10,"start":314,"end":326},{"type":10,"start":439,"end":451},{"type":10,"start":521,"end":533},{"type":10,"start":538,"end":550},{"type":3,"start":47,"end":53,"href":"https://medium.com/dartlang/dart-2-stable-and-the-dart-web-platform-3775d5f8eac7","title":"","rel":"","anchorType":0}]},{"name":"b791","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*x0J9DBRyATjtQn42","originalWidth":600,"originalHeight":600,"isFeatured":true}},{"name":"ec01","type":1,"text":"Since my goal here is to be useful, I’m going to start with a TLDR.","markups":[]},{"name":"1d6c","type":1,"text":"TL;DR: You want to use the void type 99.99% of the time.","markups":[{"type":1,"start":7,"end":56}]},{"name":"ca0a","type":1,"text":"I also recommend you turn on two void-related lint rules in your projects, right now:","markups":[{"type":10,"start":33,"end":37},{"type":3,"start":46,"end":56,"href":"https://www.dartlang.org/guides/language/analysis-options","title":"","rel":"","anchorType":0}]},{"name":"4ae6","type":9,"text":"prefer_void_to_null: Helps keep you from slipping back into the habit of typing the mostly-antiquated Null.","markups":[{"type":10,"start":102,"end":106},{"type":1,"start":0,"end":20}]},{"name":"2d1a","type":9,"text":"void_checks: Gives you voidness semantics that you may find more intuitive, even though they are not strictly necessary for safe code.","markups":[{"type":1,"start":0,"end":12}]},{"name":"8421","type":1,"text":"The rest of this article is not light reading. It is a combination of history, edge cases, and type theory. What I’m about to write is like trying to explain a Monad, but I’ll do my best, and I hope you follow along for the ride.","markups":[{"type":3,"start":160,"end":165,"href":"https://en.wikipedia.org/wiki/Monad_(functional_programming)","title":"","rel":"","anchorType":0}]},{"name":"0d3a","type":3,"text":"Quick Future<Null> trivia","markups":[]},{"name":"ac11","type":1,"text":"To demonstrate the value you might get out of reading this post, I pose a trivia question for you.","markups":[]},{"name":"16d2","type":1,"text":"Say we limit ourselves to two Futures — a Future<User> and a Future<Null>. What do the following lines of code do?","markups":[{"type":10,"start":30,"end":36},{"type":10,"start":42,"end":54},{"type":10,"start":61,"end":73}]},{"name":"4bdf","type":8,"text":"// does this fail in your editor?\nFuture<User> f1 = Future<Null>.value(null);","markups":[]},{"name":"790c","type":8,"text":"// does this fail at runtime?\nFuture<Null> f2 = Future<User>.value(0);","markups":[]},{"name":"761f","type":1,"text":"Does it help if we switch to awaits?","markups":[]},{"name":"b96a","type":8,"text":"User u = await Future<Null>.value(null);\nNull n = await Future<User>.value(0);","markups":[]},{"name":"cc32","type":1,"text":"*pauses for dramatic effect*","markups":[{"type":2,"start":0,"end":28}]},{"name":"b8ed","type":1,"text":"The answer is that none of these four lines will show any errors in your editor, unless you have disabled implicit downcasts. That’s right, taking a Future<Null> and pretending it’s something it isn’t, like Future<User>, is 100% legal. This is not the case with Future<void>!","markups":[{"type":10,"start":149,"end":161},{"type":10,"start":207,"end":219},{"type":10,"start":262,"end":274}]},{"name":"2e42","type":1,"text":"Also unintuitively, the second and fourth lines fail at runtime (it’s not “safe” to throw away the result of a Future in this way), and the others succeed silently.","markups":[{"type":10,"start":111,"end":117}]},{"name":"8b4b","type":1,"text":"These behaviors should make you uncomfortable. But don’t worry! You already know the solution: use Future<void>. I’ll break down why this unintuitive behavior works this way.","markups":[{"type":10,"start":99,"end":111}]},{"name":"a4a3","type":3,"text":"How void works now","markups":[]},{"name":"a80b","type":1,"text":"I debated a lot to myself about what the best ordering would be for this article. There are lots of concepts to explain here. However, I will try to go in order of most useful information to least useful information. Therefore, with void being much more useful than Null in Dart 2, it makes sense to start with Dart 2 void semantics.","markups":[{"type":10,"start":266,"end":270},{"type":10,"start":318,"end":322}]},{"name":"8a10","type":1,"text":"The fundamental idea behind void in Dart is derived from the goal that a void value should not be used.","markups":[{"type":10,"start":28,"end":32},{"type":10,"start":73,"end":77}]},{"name":"de85","type":8,"text":"void f() {}\nprint(f()); // error!","markups":[]},{"name":"a1e4","type":1,"text":"This is hopefully what you expect to happen! So with that, so far so good.","markups":[]},{"name":"6c9e","type":1,"text":"It’s worth noting that achieving this goal and opening up void as a fairly normal type can get a bit weird:","markups":[{"type":10,"start":58,"end":62},{"type":2,"start":43,"end":46}]},{"name":"b34d","type":8,"text":"f(void argument) {\n  print(argument); // Error!\n  // we can receive the argument, but we may not use it!\n}","markups":[]},{"name":"aa41","type":1,"text":"And this is where, in Dart 2, our new “generalized void” starts to get cool, and powerful…albeit sometimes confusing.","markups":[]},{"name":"4e16","type":1,"text":"I pose the question to you…what type of value could we pass in as the argument of f?","markups":[{"type":10,"start":82,"end":83}]},{"name":"425f","type":8,"text":"f(void argument) { … }\nf(x); // what is x?","markups":[]},{"name":"acfc","type":1,"text":"The answer to this is…anything! Because we don’t let you use the value of x inside the function f, we can confidently say that there is no value that x can take that could cause any runtime errors.","markups":[{"type":10,"start":74,"end":75},{"type":10,"start":96,"end":97},{"type":10,"start":150,"end":151},{"type":2,"start":133,"end":144},{"type":2,"start":161,"end":196}]},{"name":"612d","type":8,"text":"f(1); // will have no difference compared to\nf(“foo”); // will have no difference compared to\nf([1, 2, 3]); // will have no difference compared to\n// ...","markups":[]},{"name":"7bbf","type":1,"text":"If we derive the best semantics for void based on the idea that it is a value that will not be used, this is what we get. Which means, it’s a value that can be filled with absolutely anything. It’s like a vacuum: an input with no output.","markups":[{"type":10,"start":36,"end":40},{"type":2,"start":95,"end":99},{"type":2,"start":160,"end":166}]},{"name":"7c3d","type":1,"text":"Now, there are cases where something is always error-free at runtime, but still should cause static errors. This is a great case for a lint! And indeed this is the idea behind the void_checks lint. It looks for places where you pass anything but null into a void location, and I would encourage teams to enable it. It’s not required for soundness, but passing anything other than null into a void location is still likely to be an accident, which the lint will flag for you.","markups":[{"type":10,"start":180,"end":191},{"type":10,"start":246,"end":250},{"type":10,"start":258,"end":262},{"type":10,"start":380,"end":384},{"type":10,"start":392,"end":396}]},{"name":"a23b","type":1,"text":"Since all of this is grounded in foundational type theory, void plays well with every part of Dart, even in continuations leveraging type inference in the context of a Future<void>:","markups":[{"type":10,"start":59,"end":63},{"type":10,"start":168,"end":180}]},{"name":"eed7","type":8,"text":"Future<void>().then((x) {\n  print(x); // error! x has type “void” so you can’t print it!\n  // This is what we want!\n});","markups":[]},{"name":"b40e","type":8,"text":"// and yes, this is an error too:\nFoo f = await voidFuture();","markups":[]},{"name":"906f","type":1,"text":"At this point, the average developer probably knows everything they need to know about void in order to effectively use it.","markups":[{"type":10,"start":87,"end":91}]},{"name":"4c00","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*_2MNvj3It63IUFUH","originalWidth":268,"originalHeight":150}},{"name":"9c61","type":1,"text":"If you are still following along, however, there are a few more interesting nuggets.","markups":[]},{"name":"d82c","type":1,"text":"Even with void_checks enabled, void locations will not be guaranteed to contain null. Take this override:","markups":[{"type":10,"start":10,"end":21},{"type":10,"start":31,"end":35},{"type":10,"start":80,"end":84}]},{"name":"c90e","type":8,"text":"class A {\n  void f(Object o) {}\n}","markups":[]},{"name":"9266","type":8,"text":"class B extends A {\n  @override\n  Object f(Object o) => o;\n}","markups":[]},{"name":"b55a","type":1,"text":"We don’t want to make this override illegal, because it’s safe, useful, and would be a breaking change from Dart 1. And so we are forced to accept that void locations may hold absolutely any value. We also cannot “optimize out” the value that A.f() returns, because at runtime it may be a B!","markups":[{"type":10,"start":152,"end":156},{"type":10,"start":243,"end":248},{"type":10,"start":289,"end":290}]},{"name":"e118","type":1,"text":"Rather, we have the clever option of making void a sister type of Object. After all, it may hold any value, and all values are Objects. This is not something we designed, it’s just reality. Recognizing that reality makes it something we can then leverage.","markups":[{"type":10,"start":44,"end":48},{"type":10,"start":66,"end":72},{"type":10,"start":127,"end":134}]},{"name":"6586","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*1ZUU5fNh-kmpPzMU","originalWidth":600,"originalHeight":600}},{"name":"c5be","type":1,"text":"By making void a sibling of Object, we leave ourselves no requirements that a void value go completely unused. We try our best to keep void to itself, but we deliberately relax these restrictions in a few places for the sake of backwards compatibility:","markups":[{"type":10,"start":10,"end":14},{"type":10,"start":28,"end":34},{"type":10,"start":78,"end":82},{"type":10,"start":135,"end":139},{"type":2,"start":57,"end":70},{"type":2,"start":92,"end":102}]},{"name":"31ce","type":8,"text":"dynamic f() => voidFn(); // this is legal\nvoidFn() as dynamic; // this is legal","markups":[]},{"name":"6835","type":1,"text":"These are special cases that would be legal for an Object, and we made it legal for void, too, in the interest of making Dart 2 a smoother rollout.","markups":[{"type":10,"start":51,"end":57},{"type":10,"start":84,"end":88}]},{"name":"06da","type":1,"text":"Making void a sibling of Object also means that void can be used as a type parameter without bloating the compiled output (no “template specialization,” for you C++ folk). This reduction is good for keeping web & Flutter apps small, at the expense of allowing the following:","markups":[{"type":10,"start":7,"end":11},{"type":10,"start":25,"end":31},{"type":10,"start":48,"end":52}]},{"name":"fd3d","type":8,"text":"<void>[1, 2, 3].toString(); // this is legal and prints [1, 2, 3]","markups":[]},{"name":"fc7a","type":1,"text":"And lastly, it may seem useless to ever type a parameter as void, especially since it’s a form of Object. However, void values can be passed to void locations:","markups":[{"type":10,"start":60,"end":64},{"type":10,"start":98,"end":104},{"type":10,"start":115,"end":119},{"type":10,"start":144,"end":148},{"type":2,"start":133,"end":144},{"type":2,"start":148,"end":158}]},{"name":"6345","type":8,"text":"f(void x) { … }\nf(voidFn()); // this is legal","markups":[]},{"name":"5c8b","type":1,"text":"This is useful for sequencing, which is for instance used by Mockito when mocking methods that return void. (Replace f with when in the above code for a closer approximation.)","markups":[{"type":10,"start":102,"end":106},{"type":10,"start":117,"end":118},{"type":10,"start":124,"end":128},{"type":3,"start":61,"end":68,"href":"https://pub.dartlang.org/packages/mockito","title":"","rel":"","anchorType":0},{"type":2,"start":19,"end":29}]},{"name":"3708","type":1,"text":"In summary:","markups":[]},{"name":"3405","type":9,"text":"The void type is a sibling of Object.","markups":[{"type":10,"start":4,"end":8},{"type":10,"start":30,"end":36}]},{"name":"ea2e","type":9,"text":"Almost always, a void object can’t be used.","markups":[{"type":10,"start":17,"end":21}]},{"name":"2f6c","type":9,"text":"Something marked void could be, in practice, absolutely anything.","markups":[{"type":10,"start":17,"end":21}]},{"name":"10c4","type":9,"text":"Anything can be “thrown away” into a location marked void, and the lint void_checks restricts this behavior.","markups":[{"type":10,"start":53,"end":57},{"type":10,"start":72,"end":83}]},{"name":"be9a","type":9,"text":"A void value can be passed into other void locations.","markups":[{"type":10,"start":2,"end":6},{"type":10,"start":38,"end":42}]},{"name":"aa92","type":3,"text":"The bottom type","markups":[]},{"name":"4efe","type":1,"text":"Before I get to talking about Null, it’s critical we talk about the “bottom” type.","markups":[{"type":10,"start":30,"end":34}]},{"name":"cd1f","type":1,"text":"This is a naturally occurring type in type theory, which has a short academic definition with a few practical applications.","markups":[]},{"name":"cfc3","type":1,"text":"If you stop reading this section because it’s so dang weird, that is strong evidence of my original TLDR. Unless you want your code to be similarly dang weird, you probably want void. Now let’s explore this weird rabbit hole and see how far it goes, eh?","markups":[{"type":10,"start":178,"end":182},{"type":2,"start":41,"end":59}]},{"name":"3963","type":1,"text":"The bottom type is the subtype of all types. Put in simpler object-oriented terms, that means it’s a Person. And a Car. And an Animal. And every other type from every program ever written.","markups":[{"type":10,"start":101,"end":107},{"type":10,"start":115,"end":118},{"type":10,"start":127,"end":133}]},{"name":"50cc","type":1,"text":"If this sounds absurd, that’s because it is. I like to think of it as a “placeholder” type. But “absurd” or “imaginary” type would also be a somewhat reasonable name for it. Instead, though, it’s called the bottom type, because it’s the bottom of the type hierarchy, which, in computer science, is upside down. ¯\\_(ツ)_/¯. Formally, it may be referred to by the symbol ⊥, which you may also recognize as the symbol for “false.”","markups":[{"type":2,"start":207,"end":213}]},{"name":"088b","type":1,"text":"If you try to imagine a value that is a Person and a Car and an Animal, you won’t be able to think of anything. And surprisingly, that is where the practical usage of ⊥ comes from!","markups":[{"type":10,"start":40,"end":46},{"type":10,"start":53,"end":56},{"type":10,"start":64,"end":70},{"type":2,"start":47,"end":50},{"type":2,"start":57,"end":60}]},{"name":"6922","type":1,"text":"What if I write a function that never returns? There are two easy ways to do so:","markups":[]},{"name":"12b8","type":8,"text":"loopForever() {\n  while(true); // first way\n}","markups":[]},{"name":"956b","type":8,"text":"alwaysThrow() {\n  throw Exception(); // second way\n}","markups":[]},{"name":"b32d","type":1,"text":"What is the best return type for these two functions?","markups":[]},{"name":"61ea","type":1,"text":"It depends. Because the function never returns, the return type doesn’t really matter. You can use any type — even the absurd bottom type, which can be used in various ways in various languages.","markups":[]},{"name":"6629","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*TkwIX5BsrbSzHfLr","originalWidth":600,"originalHeight":600}},{"name":"3340","type":1,"text":"C++ has this as noreturn. Rust has !, and Scala has Nothing. But my favorite example comes from Haskell, which has a very commonly used undefined function that aborts the program. It returns, you guessed it, the bottom type.","markups":[{"type":10,"start":16,"end":24},{"type":10,"start":35,"end":36},{"type":10,"start":52,"end":59},{"type":10,"start":136,"end":145}]},{"name":"d653","type":1,"text":"If we assume an undefined function in Dart like the one in Haskell, which merely throws an exception when called and returns ⊥, then it would look like the following:","markups":[{"type":10,"start":16,"end":25}]},{"name":"b90b","type":8,"text":"Foo foo = cond ? val : undefined();","markups":[]},{"name":"16fc","type":1,"text":"In the example usage line, the program can safely run and store val when cond is true. And when cond is false, the program will throw an exception during undefined(). It is safe to “store” the result of undefined() in foo, regardless of the type of foo, because that store will never actually happen!","markups":[{"type":10,"start":64,"end":67},{"type":10,"start":73,"end":77},{"type":10,"start":96,"end":100},{"type":10,"start":154,"end":165},{"type":10,"start":203,"end":214},{"type":10,"start":249,"end":252}]},{"name":"2ab2","type":1,"text":"undefined() here does not return anything. But the lesson here is not that we can make foo empty…it’s that the bottom type is empty like an empty promise. It’s emptier than empty. It just never happens.","markups":[{"type":10,"start":0,"end":11},{"type":10,"start":87,"end":90},{"type":1,"start":11,"end":12}]},{"name":"3dc4","type":1,"text":"One thing I must be careful to state is that you can and, depending on the usage, often should return void from these functions in practice. Usually code like return loopForever() is more likely to be a mistake than a useful pattern. However, the choice is yours to make.","markups":[{"type":10,"start":102,"end":106},{"type":10,"start":159,"end":179}]},{"name":"bf7c","type":1,"text":"The bottom type is also nice for read-only empty lists. In Dart, Lists are covariant, so a List<int> is allowed to be used as a List<Object>. If you then attempt to stick a String inside that List<Object>, a runtime check will catch that for you and throw an error.","markups":[{"type":10,"start":65,"end":69},{"type":10,"start":91,"end":100},{"type":10,"start":128,"end":140},{"type":10,"start":173,"end":179},{"type":10,"start":192,"end":204}]},{"name":"9e1a","type":1,"text":"That means that if we make a List of ⊥, there’s nothing we can put into it, but we can treat it as a list of anything:","markups":[{"type":10,"start":29,"end":33}]},{"name":"df39","type":8,"text":"List<int> intList = <⊥>[];\n  for(int i in intList) {\n  print(i * 2); // valid, because this simply never happens\n}","markups":[]},{"name":"bc84","type":1,"text":"There are even more interesting cases when you look at what’s called “contravariant” placement of the bottom type.","markups":[]},{"name":"d7ca","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*OyVAekp1iwSQyfur","originalWidth":800,"originalHeight":800}},{"name":"7be3","type":1,"text":"Let’s say we define a function that has a ⊥ parameter:","markups":[]},{"name":"20f3","type":8,"text":"void f(⊥ x) {}","markups":[]},{"name":"b62b","type":1,"text":"This is almost the opposite of the undefined() example. Rather than a function that never returns, we have declared a function that can’t be called! No actual value is assignable to that parameter x. You can’t pass in a Person because it’s not also a Car, and you can’t pass in a Car because it’s not also a Person. The only thing you could pass in is the absurd type itself:","markups":[{"type":10,"start":35,"end":46},{"type":10,"start":197,"end":198},{"type":10,"start":220,"end":226},{"type":10,"start":251,"end":254},{"type":10,"start":280,"end":283},{"type":10,"start":308,"end":314},{"type":2,"start":240,"end":251}]},{"name":"5a7d","type":8,"text":"f(undefined());","markups":[]},{"name":"a4f4","type":1,"text":"But as we just covered before, undefined() never returns, so f() is still never actually called in this case!","markups":[{"type":10,"start":31,"end":42},{"type":10,"start":61,"end":64}]},{"name":"cd36","type":1,"text":"Typing a parameter as ⊥ may seem useless, but it has esoteric value because all functions that can be called are subtypes of functions that can’t be. (Think about it: a function that can be called doesn’t have to be. And if a function is not called, it cannot produce runtime errors.)","markups":[{"type":2,"start":95,"end":98},{"type":2,"start":140,"end":145},{"type":2,"start":149,"end":150},{"type":2,"start":183,"end":186},{"type":2,"start":205,"end":209}]},{"name":"670f","type":1,"text":"If you’re still with me, take a deep breath and pat yourself on the back.","markups":[]},{"name":"58fe","type":1,"text":"Specifically, it’s safe to cast any Function(X) to a Function(⊥), for any X. This is better than using Dart’s all-encompassing Function type, because it’s more specific.","markups":[{"type":10,"start":36,"end":47},{"type":10,"start":53,"end":64},{"type":10,"start":74,"end":75},{"type":10,"start":127,"end":135}]},{"name":"e04f","type":1,"text":"With this you can, for instance, store any unary function in a field and call it dynamically, to get past static errors and replace them with runtime errors if you made a mistake:","markups":[]},{"name":"d0d8","type":8,"text":"Function(⊥) f;\nf = (int x) => x + 1;","markups":[]},{"name":"442e","type":8,"text":"// the validity of 123 as an argument to f is checked at runtime\n(f as dynamic)(123);","markups":[]},{"name":"a1aa","type":1,"text":"This is a neat trick to help you in a pinch.","markups":[]},{"name":"8506","type":1,"text":"Now we can talk about Null.","markups":[{"type":10,"start":22,"end":26}]},{"name":"8e9c","type":3,"text":"Null in Dart 2","markups":[]},{"name":"60b3","type":1,"text":"The conceptual “bottom” type (a type which is a subtype of all types) exists in Dart, but that’s not all. Such a value also exists in Dart 2! In Dart we call it Null, and that value is — you guessed it — null.","markups":[{"type":10,"start":161,"end":165},{"type":10,"start":204,"end":208}]},{"name":"cf69","type":1,"text":"Since I can make anything null(/Null), the absurd type is not so absurd in Dart. Which makes it a bit complicated.","markups":[{"type":10,"start":26,"end":30},{"type":10,"start":32,"end":36}]},{"name":"5d4a","type":1,"text":"Note: The value null, of course, is not a Car, and it’s not a Person. And we do get requests for non-nullable types in Dart. So if we do make such a change to Dart, we’ll need a new bottom type, likely named something to the effect of Nothing, and it will be a truer bottom type at that.","markups":[{"type":10,"start":16,"end":20},{"type":10,"start":42,"end":45},{"type":10,"start":62,"end":68},{"type":10,"start":235,"end":242}]},{"name":"7762","type":1,"text":"Not only does Null have all the same absurd usages as the bottom type, but it also has an escape hatch. If you ever really need to return from a function that can’t return, or call a function that can’t be called, we give you an out! You can pass null in there! It would be, honestly, a bit unfair of us to do otherwise, when you look at the whole picture.","markups":[{"type":10,"start":14,"end":18},{"type":10,"start":247,"end":251}]},{"name":"db9d","type":1,"text":"It does give a whole lot of caveats, though, to an otherwise simple declaration:","markups":[]},{"name":"0170","type":8,"text":"Null nothing() => null;","markups":[]},{"name":"7da9","type":1,"text":"Null is the most specific type for foo(), so it’s a logical choice and a good starting place. The analyzer is also kind enough to warn you if you call methods on it that don’t exist:","markups":[{"type":10,"start":0,"end":4},{"type":10,"start":35,"end":40}]},{"name":"f890","type":8,"text":"nothing().x; // error! No member x on Null","markups":[]},{"name":"7573","type":1,"text":"But this may give a false illusion of safety.","markups":[]},{"name":"447a","type":8,"text":"nothing().toString(); // no error: Null defines toString()\nFoo foo = nothing(); // no error: foo will become null","markups":[]},{"name":"4445","type":8,"text":"// Acceptable for all parameter types in f(x),\n// runtime errors if f(x) expects non-null\nf(nothing());","markups":[]},{"name":"34c1","type":1,"text":"If your goal is for nothing() to be a synonym for null, then this would be the behavior you want, and Null is the correct type for your function that returns null.","markups":[{"type":10,"start":20,"end":29},{"type":10,"start":50,"end":54},{"type":10,"start":102,"end":106},{"type":10,"start":158,"end":162}]},{"name":"7558","type":1,"text":"There were good reasons for suggesting Future<Null>, and it worked while we were coming up with the new void semantics. However, it has the same holes:","markups":[{"type":10,"start":39,"end":51},{"type":10,"start":104,"end":108}]},{"name":"fa03","type":8,"text":"(await futureNull()).toString(); // no error!\nFoo foo = await futureNull(); // no error!","markups":[]},{"name":"c8cc","type":1,"text":"Essentially, by making some function f() return a Future<Null>, you are making await f() a synonym of null in your program! That’s dangerous because you can use null as if it were absolutely anything, absolutely any type. I don’t think that’s what most people want.","markups":[{"type":10,"start":37,"end":40},{"type":10,"start":50,"end":62},{"type":10,"start":79,"end":88},{"type":10,"start":102,"end":106},{"type":10,"start":161,"end":165}]},{"name":"469f","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*4NDBhLva40BBuX0f","originalWidth":600,"originalHeight":600}},{"name":"6e42","type":1,"text":"Why else might you use Future<Null> instead of Future<void>? It all goes back to that mind-boggling bottom type. You might consider Future<Null> for futures that must be awaitable but that never complete, or that always complete with an error. This is directly comparable to why a function would return Null.","markups":[{"type":10,"start":23,"end":35},{"type":10,"start":47,"end":59},{"type":10,"start":132,"end":145},{"type":10,"start":303,"end":307}]},{"name":"e850","type":1,"text":"The same logic applies to Stream<Null>: Use this for a Stream that never sends any events. This is directly comparable to why a read-only empty list may be typed as List<Null>.","markups":[{"type":10,"start":26,"end":38},{"type":10,"start":55,"end":61},{"type":10,"start":165,"end":175}]},{"name":"7ee6","type":1,"text":"Some trickier types to provide a guideline for are StreamController<Null> and Sink<Null>. These are comparable to functions. The most sound reason to use these types is to say that they should never be used. The next most sound is that you would like them to accept only synonyms of Null, which is reasonable only if you don’t have void_checks turned on.","markups":[{"type":10,"start":51,"end":73},{"type":10,"start":78,"end":88},{"type":10,"start":283,"end":287},{"type":10,"start":332,"end":343}]},{"name":"2aec","type":1,"text":"Imagine that Dart did not have null as an escape hatch for all values. Would you want to make a type Sink<⊥> that can only accept events from a Stream<⊥>, which itself never broadcasts an event? If the answer is yes, then go for it and make a Sink<Null>.","markups":[{"type":10,"start":31,"end":35},{"type":10,"start":101,"end":108},{"type":10,"start":144,"end":153},{"type":10,"start":243,"end":253}]},{"name":"bc28","type":1,"text":"All of these usages have weak guarantees because the value null itself is an escape hatch for why you otherwise would be most likely to use the Null type itself. However, do not make the mistake of thinking that the value is the escape hatch itself, rather than the bunker. One is safe and sturdy and the other is to save you the effort of digging upwards through reinforced concrete when the bunker catches on fire with you in it.","markups":[{"type":10,"start":59,"end":63},{"type":10,"start":144,"end":148},{"type":2,"start":216,"end":221}]},{"name":"d901","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*yepcr98D1YlpsRJF","originalWidth":1000,"originalHeight":1000}},{"name":"c858","type":1,"text":"In summary, here are the main uses of typing something as Null:","markups":[{"type":10,"start":58,"end":62}]},{"name":"459a","type":9,"text":"As a synonym for null, usable everywhere as everything","markups":[{"type":10,"start":17,"end":21}]},{"name":"5d78","type":9,"text":"As a placeholder for execution your program will never reach","markups":[]},{"name":"10cc","type":9,"text":"As a container that must stay empty so that it can masquerade as any type","markups":[]},{"name":"fc14","type":9,"text":"As an output with no inputs","markups":[]},{"name":"e83e","type":3,"text":"Final comparison","markups":[]},{"name":"b4a9","type":1,"text":"If you reached this point of the article, you deserve some sort of recompense — reach out to me and I’ll see about buying you a beer next time you’re free in Portland OR. :)","markups":[{"type":2,"start":0,"end":173}]},{"name":"2a57","type":1,"text":"I talked a lot about the bottom type, but I didn’t get into its opposite at all, Top. The top type is, as you would expect, the polar opposite of the bottom type. And while Dart’s name for the bottom type is Null, Dart’s name for the top type is one of dynamic, Object, and void (three heads of the same coin).","markups":[{"type":10,"start":208,"end":212},{"type":10,"start":253,"end":260},{"type":10,"start":262,"end":268},{"type":10,"start":274,"end":278}]},{"name":"080c","type":1,"text":"It may seem strange that words like “nothing” and “empty” in English can mean two such dissimilar things in type theory. Both are suitable descriptions of the exact opposite top and bottom types, and therefore, of Null and void. It may seem strange that two opposite types are appealing candidates for the same job! It may seem frustrating that Dart has so many weird quirks and edge cases, now that you’re reading up on which to use.","markups":[{"type":10,"start":214,"end":218},{"type":10,"start":223,"end":227}]},{"name":"2485","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*ybPT9jlu0yGAnu2v","originalWidth":1000,"originalHeight":1000}},{"name":"e1aa","type":1,"text":"Our mistake, I think, was in ever recommending Null to be used like void in the first place. It would at the time have been a disservice to users to withhold what was useful advice, given Dart 1 semantics. But we accidentally made a very esoteric type very commonly used.","markups":[{"type":10,"start":47,"end":51},{"type":10,"start":68,"end":72},{"type":2,"start":233,"end":237},{"type":2,"start":252,"end":256}]},{"name":"3703","type":1,"text":"Well you’ve read the article now. What do you think? Do you expect to come across a valid use for Null any time soon? Do you have a firm understanding of where it’s useful?","markups":[{"type":10,"start":98,"end":102}]},{"name":"4230","type":1,"text":"And more importantly, can you help us spread the good news that void is here to make it all simpler?","markups":[{"type":10,"start":64,"end":68}]}],"sections":[{"name":"bb6d","startIndex":0}]},"postDisplay":{"coverless":true}},"virtuals":{"statusForCollection":"APPROVED","allowNotes":true,"previewImage":{"imageId":"0*x0J9DBRyATjtQn42","filter":"","backgroundSize":"","originalWidth":600,"originalHeight":600,"strategy":"resample","height":0,"width":0},"wordCount":3255,"imageCount":8,"readingTime":13.416352201257862,"subtitle":"One of the nice upgrades we were able to do in Dart 2 (in addition to better static checking, runtime type safety, optional new/const…","userPostRelation":{"userId":"8b6a7f6f197d","postId":"84a42d616e7d","readAt":0,"readLaterAddedAt":0,"votedAt":0,"collaboratorAddedAt":0,"notesAddedAt":0,"subscribedAt":0,"lastReadSectionName":"","lastReadVersionId":"","lastReadAt":0,"lastReadParagraphName":"","lastReadPercentage":0,"viewedAt":0,"presentedCountInResponseManagement":0,"clapCount":0,"seriesUpdateNotifsOptedInAt":0,"queuedAt":0,"seriesFirstViewedAt":0,"presentedCountInStream":2,"seriesLastViewedAt":0,"audioProgressSec":0},"publishedInCount":1,"usersBySocialRecommends":[],"noIndex":false,"recommends":62,"isBookmarked":false,"tags":[{"slug":"type-theory","name":"Type Theory","postCount":64,"metadata":{"postCount":64,"coverImage":{"id":"0*Uo5vWB0k6vy3SL1e","originalWidth":5094,"originalHeight":3396,"unsplashPhotoId":"EbUHz58Jba8"}},"type":"Tag"},{"slug":"dart","name":"Dart","postCount":13858,"metadata":{"postCount":13858,"coverImage":{"id":"1*rQugDrmwFFsEDL_CqSBJNw.png","originalWidth":1536,"originalHeight":1024,"isFeatured":true}},"type":"Tag"},{"slug":"dartlang","name":"Dartlang","postCount":921,"metadata":{"postCount":921,"coverImage":{"id":"1*HNqQFQ2hdhAgjew1pIMqXA.png","originalWidth":2752,"originalHeight":1536,"isFeatured":true}},"type":"Tag"},{"slug":"programming-languages","name":"Programming Languages","postCount":14860,"metadata":{"postCount":14860,"coverImage":{"id":"1*sD09-ccQCGBvaNKvzpbTbw.png","originalWidth":1690,"originalHeight":964,"isFeatured":true}},"type":"Tag"},{"slug":"design-patterns","name":"Design Patterns","postCount":18398,"metadata":{"postCount":18398,"coverImage":{"id":"1*J0ttOWIWxPImLMWLWojp3w.png","originalWidth":1456,"originalHeight":816,"isFeatured":true}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":2,"links":{"entries":[{"url":"https://en.wikipedia.org/wiki/Monad_(functional_programming)","alts":[],"httpStatus":200},{"url":"https://pub.dartlang.org/packages/mockito","alts":[],"httpStatus":200},{"url":"https://www.dartlang.org/guides/language/analysis-options","alts":[],"httpStatus":200},{"url":"https://medium.com/dartlang/dart-2-stable-and-the-dart-web-platform-3775d5f8eac7","alts":[{"type":2,"url":"medium://p/3775d5f8eac7"},{"type":3,"url":"medium://p/3775d5f8eac7"}],"httpStatus":200}],"version":"0.3","generatedAt":1540920383768},"isLockedPreviewOnly":false,"metaDescription":"","totalClapCount":518,"sectionCount":1,"readingList":0,"topics":[{"topicId":"decb52b64abf","slug":"programming","createdAt":1493934116328,"deletedAt":0,"image":{"id":"1*iPa136b1cGEO7lvoXg6uHQ@2x.jpeg","originalWidth":6016,"originalHeight":4016},"name":"Programming","description":"The good, the bad, the buggy.","relatedTopics":[],"visibility":1,"relatedTags":[],"relatedTopicIds":[],"seoTitle":"Programming News and Articles — Medium","type":"Topic"}]},"coverless":true,"slug":"future-void-vs-future-null-whats-the-difference","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":false,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"future-void-vs-future-null-whats-the-difference-84a42d616e7d","previewContent":{"bodyModel":{"paragraphs":[{"name":"previewImage","type":4,"text":"","layout":10,"metadata":{"id":"0*x0J9DBRyATjtQn42","originalWidth":600,"originalHeight":600,"isFeatured":true}},{"name":"ef07","type":3,"text":"Future<void> vs Future<Null>, what’s the difference?","markups":[],"alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false,"subtitle":"One of the nice upgrades we were able to do in Dart 2 (in addition to better static checking, runtime type safety, optional new/const…"},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://blog.dart.dev/future-void-vs-future-null-whats-the-difference-84a42d616e7d","approvedHomeCollectionId":"23738d481ce8","isNewsletter":false,"newsletterId":"","webCanonicalUrl":"https://blog.dart.dev/future-void-vs-future-null-whats-the-difference-84a42d616e7d","mediumUrl":"https://blog.dart.dev/future-void-vs-future-null-whats-the-difference-84a42d616e7d","migrationId":"","notifyFollowers":true,"notifyTwitter":false,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isEligibleForRevenue":false,"isBlockedFromHightower":false,"deletedAt":0,"lockedPostSource":0,"hightowerMinimumGuaranteeStartsAt":0,"hightowerMinimumGuaranteeEndsAt":0,"featureLockRequestAcceptedAt":0,"mongerRequestType":1,"layerCake":0,"socialTitle":"","socialDek":"","editorialPreviewTitle":"","editorialPreviewDek":"","curationEligibleAt":0,"isProxyPost":false,"proxyPostFaviconUrl":"","proxyPostProviderName":"","proxyPostType":0,"isSuspended":false,"isLimitedState":false,"seoTitle":"","previewContent2":{"bodyModel":{"paragraphs":[{"name":"ef07","type":3,"text":"Future<void> vs Future<Null>, what’s the difference?","markups":[]},{"name":"59d5","type":1,"text":"One of the nice upgrades we were able to do in Dart 2 (in addition to better static checking, runtime type safety, optional new/const, core library improvements, and more) is to formalize void in a way that’s both more useful and less error-prone. This is especially clean in async programming…","markups":[{"type":10,"start":188,"end":192},{"type":10,"start":314,"end":326},{"type":10,"start":439,"end":451},{"type":10,"start":521,"end":533},{"type":10,"start":538,"end":550},{"type":3,"start":47,"end":53,"href":"https://medium.com/dartlang/dart-2-stable-and-the-dart-web-platform-3775d5f8eac7","title":"","rel":"","anchorType":0}]}],"sections":[{"name":"bb6d","startIndex":0}]},"isFullContent":false,"subtitle":"One of the nice upgrades we were able to do in Dart 2 (in addition to better static checking, runtime type safety, optional new/const…"},"cardType":0,"isDistributionAlertDismissed":false,"isShortform":false,"shortformType":0,"responsesLocked":false,"isLockedResponse":false,"isPublishToEmail":false,"responseDistribution":0,"isMarkedPaywallOnly":false,"type":"Post"},"mentionedUsers":[],"collaborators":[],"hideMeter":false,"shareKey":"2823cfcb3e7b59061a1dc1f3ba8cccbe","collectionUserRelations":[{"collectionId":"23738d481ce8","userId":"8b6a7f6f197d","role":"ADMIN"},{"collectionId":"4da7dfd21a33","userId":"8b6a7f6f197d","role":"WRITER"},{"collectionId":"24d8f4fa8912","userId":"8b6a7f6f197d","role":"WRITER"}],"mode":"canEdit","references":{"User":{"c9094de7d9b1":{"userId":"c9094de7d9b1","name":"Mike Fairhurst","username":"mfairhurst","createdAt":1511889811947,"imageId":"0*dtDujtysqs_DBFUb.","backgroundImageId":"","bio":"","twitterScreenName":"","socialStats":{"userId":"c9094de7d9b1","usersFollowedCount":2,"usersFollowedByCount":89,"type":"SocialStats"},"social":{"userId":"8b6a7f6f197d","targetUserId":"c9094de7d9b1","type":"Social"},"allowNotes":1,"mediumMemberAt":0,"isWriterProgramEnrolled":true,"isSuspended":false,"isMembershipTrialEligible":true,"facebookDisplayName":"","optInToIceland":true,"hasCompletedProfile":false,"hasSeenIcelandOnboarding":false,"postSubscribeMembershipUpsellShownAt":0,"languageCode":"en-us","type":"User"}},"Collection":{"23738d481ce8":{"id":"23738d481ce8","name":"Dart","slug":"dartlang","tags":["MOBILE APP DEVELOPMENT","WEB DEVELOPMENT","DART","PROGRAMMING LANGUAGES","SOFTWARE DEVELOPMENT"],"creatorId":"a6d788faa5e5","description":"Dart is an approachable, portable, and productive language for high-quality apps on any platform. Learn more at https://dart.dev.","shortDescription":"Dart is an approachable, portable, and productive language…","image":{"imageId":"1*uWy1Ajpd0oTUQBO9WBHoQg@2x.png","filter":"","backgroundSize":"","originalWidth":1001,"originalHeight":1001,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":14031,"activeAt":1762974121956},"virtuals":{"permissions":{"canPublish":true,"canPublishAll":true,"canRepublish":true,"canRemove":true,"canManageAll":true,"canSubmit":true,"canEditPosts":true,"canAddWriters":true,"canViewStats":true,"canSendNewsletter":true,"canViewLockedPosts":true,"canViewCloaked":true,"canEditOwnPosts":true,"canBeAssignedAuthor":true,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false,"canLockOwnPostsForMediumMembers":false,"canViewNewsletterV2Stats":true,"canCreateNewsletterV3":true},"isSubscribed":true,"isEnrolledInHightower":false,"isEligibleForHightower":false,"isSubscribedToCollectionEmails":false,"isMuted":false,"canToggleEmail":false,"isWriter":false},"logo":{"imageId":"1*NRb7RFVWJQFzY47j3v4U7Q.png","filter":"","backgroundSize":"","originalWidth":400,"originalHeight":154,"strategy":"resample","height":0,"width":0},"twitterUsername":"dart_lang","publicEmail":"medium@dartlang.org","domain":"blog.dart.dev","sections":[{"type":2,"collectionHeaderMetadata":{"title":"Dart","description":"An approachable, portable, and productive language for high-quality apps on any platform","backgroundImage":{},"logoImage":{"id":"1*knHF_qpxdtS8h0Z8EeqowA@2x.png","originalWidth":1080,"originalHeight":1080,"alt":"Dart"},"alignment":2,"layout":5}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":7,"postIds":[]}},{"type":1,"postListMetadata":{"source":1,"layout":5,"number":15,"postIds":[]}}],"tintColor":"#FF042B59","lightText":true,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF6588BA","point":0},{"color":"#FF607EAB","point":0.1},{"color":"#FF59759C","point":0.2},{"color":"#FF536B8E","point":0.3},{"color":"#FF4C617F","point":0.4},{"color":"#FF445670","point":0.5},{"color":"#FF3D4B61","point":0.6},{"color":"#FF344052","point":0.7},{"color":"#FF2B3442","point":0.8},{"color":"#FF212832","point":0.9},{"color":"#FF161A22","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FF042B59","point":0},{"color":"#FF294871","point":0.1},{"color":"#FF456087","point":0.2},{"color":"#FF5F779B","point":0.3},{"color":"#FF788DAD","point":0.4},{"color":"#FF8FA2BF","point":0.5},{"color":"#FFA5B6CF","point":0.6},{"color":"#FFBBC9DF","point":0.7},{"color":"#FFD1DCEE","point":0.8},{"color":"#FFE6EEFC","point":0.9},{"color":"#FFFBFFFF","point":1}],"backgroundColor":"#FF042B59"},"highlightSpectrum":{"colorPoints":[{"color":"#FFECF3FF","point":0},{"color":"#FFE9F2FF","point":0.1},{"color":"#FFE5F0FF","point":0.2},{"color":"#FFE2EFFF","point":0.3},{"color":"#FFDEEDFF","point":0.4},{"color":"#FFDBEBFF","point":0.5},{"color":"#FFD7EAFF","point":0.6},{"color":"#FFD3E8FF","point":0.7},{"color":"#FFCFE6FF","point":0.8},{"color":"#FFCBE5FF","point":0.9},{"color":"#FFC8E3FF","point":1}],"backgroundColor":"#FFFFFFFF"},"darkBackgroundSpectrum":{"colorPoints":[{"color":"#FF7DA0D3","point":0},{"color":"#FF89A9D8","point":0.1},{"color":"#FF94B1DC","point":0.2},{"color":"#FFA0B9E0","point":0.3},{"color":"#FFABC1E3","point":0.4},{"color":"#FFB6C9E7","point":0.5},{"color":"#FFC0D1EB","point":0.6},{"color":"#FFCBD8EF","point":0.7},{"color":"#FFD5E0F2","point":0.8},{"color":"#FFE0E7F6","point":0.9},{"color":"#FFEAEFFA","point":1}],"backgroundColor":"#FF000000"}},"navItems":[{"type":1,"title":"Announcements","tagSlug":"announcements","url":"https://blog.dart.dev/tagged/announcements","source":"tagSlug"},{"type":5,"title":"Archive","url":"https://blog.dart.dev/archive"},{"type":3,"title":"dart.dev","url":"https://dart.dev"}],"colorBehavior":2,"collectionFeatures":[25],"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"Dart","description":"An approachable, portable, and productive language for high-quality apps on any platform","backgroundImage":{},"logoImage":{"id":"1*knHF_qpxdtS8h0Z8EeqowA@2x.png","originalWidth":1080,"originalHeight":1080,"alt":"Dart"},"alignment":2,"layout":5},"subscriberCount":14031,"tagline":"Dart is a client-optimized language for fast apps on any platform.","isOptedIntoAurora":false,"isCurationAllowedByDefault":false,"polarisCoverImage":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"ptsQualifiedAt":1616092887098,"type":"Collection"}},"Social":{"c9094de7d9b1":{"userId":"8b6a7f6f197d","targetUserId":"c9094de7d9b1","type":"Social"}},"SocialStats":{"c9094de7d9b1":{"userId":"c9094de7d9b1","usersFollowedCount":2,"usersFollowedByCount":89,"type":"SocialStats"}}}},"v":3,"b":"20260130-1012-root"}