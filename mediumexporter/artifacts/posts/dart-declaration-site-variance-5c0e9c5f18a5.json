{"success":true,"payload":{"value":{"id":"5c0e9c5f18a5","versionId":"de693d711c35","creatorId":"5349d10e4a3b","homeCollectionId":"23738d481ce8","title":"Dart declaration-site variance","detectedLanguage":"en","latestVersion":"de693d711c35","latestPublishedVersion":"de693d711c35","hasUnpublishedEdits":false,"latestRev":891,"createdAt":1576548520405,"updatedAt":1639353878739,"acceptedAt":0,"firstPublishedAt":1576780701845,"latestPublishedAt":1576781549665,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"A deep dive into an experimental feature","bodyModel":{"paragraphs":[{"name":"43e9","type":3,"text":"Dart declaration-site variance","markups":[]},{"name":"73f4","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*XcEdm2vmIBW8Wovr","originalWidth":1040,"originalHeight":502,"isFeatured":true,"alt":"A code snippet showing the contravariant variance modifier (`in`) in use."}},{"name":"502f","type":1,"text":"Declaration-site variance was my internship project on the Dart team, and I’ve documented my personal experience on the team in the article Life as a Dart intern. As the primary implementer of the declaration-site variance feature, I want to share the usages and benefits of sound variance.","markups":[{"type":3,"start":140,"end":161,"href":"https://medium.com/dartlang/life-as-a-dart-intern-a62cb8db2414","title":"","rel":"","anchorType":0},{"type":3,"start":197,"end":230,"href":"https://github.com/dart-lang/language/issues/524","title":"","rel":"","anchorType":0}]},{"name":"bf7b","type":1,"text":"We’ll discuss how to use variance, why we want to use the modifiers, how the feature can build on top of classes that don’t use the modifiers, and what benefits this feature provides us.","markups":[]},{"name":"78a2","type":1,"text":"Note: The implementation of variance isn’t finished yet. Although you can play with it by enabling the experiment (instructions below), the feature might change before it’s finalized.","markups":[{"type":1,"start":0,"end":5},{"type":2,"start":0,"end":183}]},{"name":"b8bc","type":1,"text":"Before diving into Dart’s declaration-site variance feature, we’ll take a quick detour to discuss what variance means and how it’s used.","markups":[]},{"name":"eca3","type":3,"text":"What is variance?","markups":[{"type":1,"start":0,"end":17}]},{"name":"d52b","type":1,"text":"To briefly introduce variance, we can look at this example:","markups":[]},{"name":"92db","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"a213f1dad314a16c2281caea8a838c78","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"c05c","type":1,"text":"From this, an Iterable of integers can be substituted as an Iterable of Objects because an integer is an Object and can be used in an Iterable in every place an Object would be. The language allows this by saying that two instantiations of the same generic type (like Iterable<int> and Iterable<Object> here) are considered subtypes if their type arguments (int and Object) are. This subtyping relation is considered covariance.","markups":[{"type":10,"start":14,"end":22},{"type":10,"start":60,"end":68},{"type":10,"start":72,"end":78},{"type":10,"start":105,"end":111},{"type":10,"start":134,"end":142},{"type":10,"start":161,"end":167},{"type":10,"start":268,"end":281},{"type":10,"start":286,"end":302},{"type":10,"start":358,"end":361},{"type":10,"start":366,"end":372},{"type":1,"start":417,"end":427},{"type":2,"start":99,"end":101}]},{"name":"8107","type":1,"text":"This is convenient and logical. It makes sense, that is, until you take a look at the variance of the parameters of a method. Say you want to make a objectWriter in Dart:","markups":[{"type":10,"start":149,"end":161}]},{"name":"fbd2","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"a2f87f5c17d57f66734c6f8b9551d9bf","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"3f29","type":1,"text":"Then you eagerly have your objectWriter write a String to discover that it produces a runtime error. The compiler allows this code, but when you run it, it throws an exception.","markups":[{"type":10,"start":27,"end":39},{"type":10,"start":48,"end":54}]},{"name":"f285","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"2c8b077a9cae4da62da97f64a63d1488","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"9674","type":1,"text":"Why is this? With contravariance, the subtyping relation is reversed compared to covariance. We need to be able to write any Object to the objectWriter, but from earlier we know that the objectWriter is actually a disguised writer of integers.","markups":[{"type":10,"start":125,"end":131},{"type":10,"start":139,"end":151},{"type":10,"start":187,"end":199},{"type":1,"start":18,"end":33},{"type":2,"start":115,"end":120}]},{"name":"b860","type":1,"text":"The final variant type you will need to know about is invariance. Invariant subtyping relation means no subtype relation between two invariant types unless they are the exact same type.","markups":[{"type":1,"start":54,"end":64},{"type":2,"start":169,"end":179}]},{"name":"b960","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"a21b886c8f60c9bb654907b193155236","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"0ea5","type":3,"text":"What is the variance feature in Dart?","markups":[{"type":1,"start":0,"end":37}]},{"name":"72ed","type":1,"text":"Since the Dart team proposed to add explicit variance modifiers to the language, we’ll preview some of the changes to expect.","markups":[]},{"name":"abed","type":1,"text":"Dart will have variance modifiers that can be applied to type parameters in classes and mixins. The syntax is similar to variance modifiers in C#.","markups":[]},{"name":"6a6e","type":1,"text":"You can use the keywords out, in, and inoutto declare a covariant, contravariant, and invariant type parameter respectively. This is used with generic types as such:","markups":[{"type":10,"start":25,"end":28},{"type":10,"start":30,"end":32},{"type":10,"start":38,"end":43},{"type":2,"start":32,"end":34}]},{"name":"8533","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"fc85a7af3115c32a364a8cd873a3004a","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"5810","type":3,"text":"Why define explicit variance for generic types? Why do we want this feature?","markups":[{"type":1,"start":0,"end":76}]},{"name":"4876","type":1,"text":"Dart’s static type system currently treats all type parameters as covariant. That’s correct and convenient for generics where the type is used in a safely covariant place like a return type. But it’s wrong when the type argument should be contravariant or invariant:","markups":[]},{"name":"01d6","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"a7117be976004d877c11a6d461c888d9","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"ba74","type":1,"text":"When you use objectWriter, you expect to be able to write any Object. Unfortunately, the objectWriter only writes integers. The compiler doesn’t know any better and when you run the code, you receive the dreaded runtime error. To avoid unsoundness, Dart throws an error at runtime if you use a type argument in an unsafe way.","markups":[{"type":10,"start":13,"end":25},{"type":10,"start":62,"end":68},{"type":10,"start":89,"end":101},{"type":2,"start":31,"end":37}]},{"name":"46b3","type":1,"text":"Fortunately, adding a variance modifier turns this incorrect use from a runtime error into a compile-time error.","markups":[]},{"name":"31d0","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"f010e9130f24f791c6e00738811bb3a6","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"7c38","type":1,"text":"This is much better. Long before you write objectWriter.write(\"I'm a string!\"), the compiler will notify you that there’s something wrong.","markups":[{"type":10,"start":43,"end":78}]},{"name":"3540","type":1,"text":"Now, let’s take a look at what adding safely typed parameters using a variance modifier provides you.","markups":[]},{"name":"bc58","type":3,"text":"Type parameters in members","markups":[{"type":1,"start":0,"end":26}]},{"name":"bcaa","type":1,"text":"If you mark a generic type parameter with out, the compiler emits a static error if you use that type in a method or field in a place that isn’t safely covariant like a return type. Likewise, a type parameter marked in can only be used in a place that is safely contravariant like a method parameter type. Type parameters marked inout can be used anywhere.","markups":[{"type":10,"start":42,"end":45},{"type":10,"start":216,"end":218},{"type":10,"start":329,"end":334}]},{"name":"3411","type":1,"text":"Here are some method variance position errors and correct usages that you may find helpful. The same error checking also occurs for mixins.","markups":[]},{"name":"711a","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"3b0c16a20c5dfea8c2ec4f685653836e","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"42b2","type":1,"text":"Errors can be emitted in fields as well.","markups":[]},{"name":"1075","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"8a012b2476894c85e83bbd9ce4caf9da","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"bd93","type":3,"text":"Assignment and subtyping","markups":[{"type":1,"start":0,"end":24}]},{"name":"da88","type":1,"text":"The errors the compiler reports for misusing type parameters help the generic class author write correct code. The other half is the set of errors that help others use the class correctly. One of the changes that come with sound variance modifiers is the subtyping change that we can see through assignment.","markups":[{"type":1,"start":91,"end":96},{"type":1,"start":164,"end":167}]},{"name":"e053","type":1,"text":"If a generic type parameter is covariant, then you can assign it when its type argument is a subtype of the expected type’s type argument. For example, you can assign a Reader<int> to something that expects a Reader<Object>.","markups":[{"type":10,"start":169,"end":180},{"type":10,"start":209,"end":223}]},{"name":"588e","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"46b7153790b49463f0d9fb5a94c6bc64","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"9d3f","type":1,"text":"Likewise, if a generic type parameter is contravariant, assignment is allowed when its type argument is a supertype of the expected type’s type argument. You can assign a Writer<Object> to something that expects a Writer<int>, as such:","markups":[{"type":10,"start":171,"end":185},{"type":10,"start":214,"end":225}]},{"name":"82e2","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"f27a4a017c0d9beb775629fb7802ecdf","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"7cc1","type":1,"text":"For invariant parameters, the type argument must be the same type.","markups":[]},{"name":"80ba","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"822bb2def25627eef48876f0eef2e994","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"ac97","type":3,"text":"Interface inheritance","markups":[{"type":1,"start":0,"end":21}]},{"name":"19e1","type":1,"text":"So you might be asking, “Can we opt into stronger compile time checking with variance even when extending older classes?” The good news is that you can; however, there are a few restrictions.","markups":[{"type":2,"start":25,"end":121}]},{"name":"8519","type":1,"text":"out parameters can only extend parameter positions that are covariant or have default Dart type variance.","markups":[{"type":10,"start":0,"end":3}]},{"name":"8199","type":1,"text":"Keep in mind that any methods inherited from legacy classes could still be unsoundly variant, and hence may still cause runtime errors. Otherwise, all new methods in a subclass with type parameters that have variance modifiers will emit errors if the types are in unsound positions.","markups":[]},{"name":"da17","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"515314c65eb313216514d8a608afa66e","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"2ba0","type":1,"text":"in parameters can only extend parameter positions that are contravariant.","markups":[{"type":10,"start":0,"end":2}]},{"name":"97dd","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"046193ad3a8e00c6afdc58b5bfb446ce","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"ec9a","type":1,"text":"inout parameters can extend all parameter positions. However, a parameter that is defined as inout can only be inherited by other invariant positions.","markups":[{"type":10,"start":0,"end":5},{"type":10,"start":93,"end":98}]},{"name":"f57f","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"54d4a38240d2af697e3852c377e71d72","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"47c6","type":3,"text":"How can I give feedback on the variance feature?","markups":[]},{"name":"8133","type":1,"text":"We recommend trying the variance feature using the latest dev channel. Play around with this example to get a grasp on how variance works and what it can do for you.","markups":[{"type":3,"start":51,"end":69,"href":"https://dart.dev/get-dart#about-release-channels-and-version-strings","title":"","rel":"","anchorType":0}]},{"name":"c5fa","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"204f165a23c7c2f1961add7f27199cc0","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fgithub.githubassets.com%2Fimages%2Fmodules%2Fgists%2Fgist-og-image.png&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"e98a","type":1,"text":"Because the variance feature is still being implemented, you need to set an experimental flag to enable it:","markups":[]},{"name":"42bc","type":8,"text":"dart --enable-experiment=variance variance_example.dart","markups":[]},{"name":"a6ea","type":1,"text":"We appreciate any and all feedback! You can let us know what you think in this GitHub issue.","markups":[{"type":3,"start":74,"end":91,"href":"https://github.com/dart-lang/language/issues/524","title":"","rel":"","anchorType":0}]},{"name":"d8ed","type":3,"text":"Summary","markups":[{"type":1,"start":0,"end":7}]},{"name":"2e61","type":1,"text":"Existing Dart generics are covariant by default, which makes it easy to start writing new classes and to get started. This means, however, that more errors appear at runtime rather than at compile time. The user is also paying for the cost of additional runtime checks. The main idea behind variance is to provide users with more informative error checking at compile time.","markups":[]},{"name":"66ec","type":1,"text":"Variance is defined only for the parameters of generic classes and mixins. Users can use the variance feature by adding one of the in, out or inout keywords before a type parameter.","markups":[{"type":10,"start":131,"end":133},{"type":10,"start":135,"end":138},{"type":10,"start":142,"end":147}]},{"name":"a843","type":1,"text":"Additionally, new generic interfaces with these modifiers can extend legacy interfaces with no variance modifiers.","markups":[]},{"name":"a1f2","type":1,"text":"Declaration-site variance allows you to reap a bunch of new benefits, including:","markups":[]},{"name":"6724","type":9,"text":"Compile-time variant position checking within members of the interface","markups":[]},{"name":"969b","type":9,"text":"Removal of pesky runtime errors that occur with down and up casting","markups":[]},{"name":"60d0","type":9,"text":"Additional subtyping changes based on the variance declared","markups":[]},{"name":"a805","type":9,"text":"More informative and accessible error checking","markups":[]},{"name":"5fbd","type":1,"text":"Now you won’t have to worry if that objectWriter is truly a writer of any object. You know it is.","markups":[{"type":10,"start":36,"end":48},{"type":2,"start":52,"end":57},{"type":2,"start":86,"end":90}]}],"sections":[{"name":"b3cf","startIndex":0}]},"postDisplay":{"coverless":true},"metaDescription":"Read about Dart’s declaration-site variance feature, the motivation behind it, how to use it, and what its benefits are."},"virtuals":{"statusForCollection":"APPROVED","allowNotes":true,"previewImage":{"imageId":"0*XcEdm2vmIBW8Wovr","filter":"","backgroundSize":"","originalWidth":1040,"originalHeight":502,"strategy":"resample","height":0,"width":0},"wordCount":1231,"imageCount":1,"readingTime":4.845283018867924,"subtitle":"A deep dive into an experimental feature","userPostRelation":{"userId":"8b6a7f6f197d","postId":"5c0e9c5f18a5","readAt":0,"readLaterAddedAt":0,"votedAt":0,"collaboratorAddedAt":0,"notesAddedAt":0,"subscribedAt":0,"lastReadSectionName":"","lastReadVersionId":"","lastReadAt":0,"lastReadParagraphName":"","lastReadPercentage":0,"viewedAt":0,"presentedCountInResponseManagement":0,"clapCount":0,"seriesUpdateNotifsOptedInAt":0,"queuedAt":0,"seriesFirstViewedAt":0,"presentedCountInStream":2,"seriesLastViewedAt":0,"audioProgressSec":0},"publishedInCount":1,"usersBySocialRecommends":[],"noIndex":false,"recommends":97,"isBookmarked":false,"tags":[{"slug":"programming","name":"Programming","postCount":400575,"metadata":{"postCount":400575,"coverImage":{"id":"0*7x-LQAg1xBmi-L1p","originalWidth":1800,"originalHeight":1169,"alt":"Screenshot of a desktop with the Cursor application open"}},"type":"Tag"},{"slug":"variance","name":"Variance","postCount":404,"metadata":{"postCount":404,"coverImage":{"id":"0*iD4V3h-0lVJObu-K.jpg","originalWidth":960,"originalHeight":533,"isFeatured":true}},"type":"Tag"},{"slug":"programming-languages","name":"Programming Languages","postCount":14860,"metadata":{"postCount":14860,"coverImage":{"id":"1*sD09-ccQCGBvaNKvzpbTbw.png","originalWidth":1690,"originalHeight":964,"isFeatured":true}},"type":"Tag"},{"slug":"dartlang","name":"Dartlang","postCount":921,"metadata":{"postCount":921,"coverImage":{"id":"1*HNqQFQ2hdhAgjew1pIMqXA.png","originalWidth":2752,"originalHeight":1536,"isFeatured":true}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":2,"links":{"entries":[{"url":"https://dart.dev/get-dart#about-release-channels-and-version-strings","alts":[],"httpStatus":200},{"url":"https://medium.com/dartlang/life-as-a-dart-intern-a62cb8db2414","alts":[{"type":2,"url":"medium://p/a62cb8db2414"},{"type":3,"url":"medium://p/a62cb8db2414"}],"httpStatus":200},{"url":"https://github.com/dart-lang/language/issues/524","alts":[],"httpStatus":200}],"version":"0.3","generatedAt":1576781550748},"isLockedPreviewOnly":false,"metaDescription":"Read about Dart’s declaration-site variance feature, the motivation behind it, how to use it, and what its benefits are.","totalClapCount":941,"sectionCount":1,"readingList":0,"topics":[{"topicId":"decb52b64abf","slug":"programming","createdAt":1493934116328,"deletedAt":0,"image":{"id":"1*iPa136b1cGEO7lvoXg6uHQ@2x.jpeg","originalWidth":6016,"originalHeight":4016},"name":"Programming","description":"The good, the bad, the buggy.","relatedTopics":[],"visibility":1,"relatedTags":[],"relatedTopicIds":[],"seoTitle":"Programming News and Articles — Medium","type":"Topic"}]},"coverless":true,"slug":"dart-declaration-site-variance","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":false,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"dart-declaration-site-variance-5c0e9c5f18a5","previewContent":{"bodyModel":{"paragraphs":[{"name":"previewImage","type":4,"text":"","layout":10,"metadata":{"id":"0*XcEdm2vmIBW8Wovr","originalWidth":1040,"originalHeight":502,"isFeatured":true,"alt":"A code snippet showing the contravariant variance modifier (`in`) in use."}},{"name":"previewTitle","type":3,"text":"Dart declaration-site variance","alignment":1},{"name":"previewSubtitle","type":13,"text":"A deep dive into an experimental feature","alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false,"subtitle":"A deep dive into an experimental feature"},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://blog.dart.dev/dart-declaration-site-variance-5c0e9c5f18a5","approvedHomeCollectionId":"23738d481ce8","isNewsletter":false,"newsletterId":"","webCanonicalUrl":"https://blog.dart.dev/dart-declaration-site-variance-5c0e9c5f18a5","mediumUrl":"https://blog.dart.dev/dart-declaration-site-variance-5c0e9c5f18a5","migrationId":"","notifyFollowers":true,"notifyTwitter":false,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isEligibleForRevenue":false,"isBlockedFromHightower":false,"deletedAt":0,"lockedPostSource":0,"hightowerMinimumGuaranteeStartsAt":0,"hightowerMinimumGuaranteeEndsAt":0,"featureLockRequestAcceptedAt":0,"mongerRequestType":1,"layerCake":0,"socialTitle":"","socialDek":"","editorialPreviewTitle":"","editorialPreviewDek":"","curationEligibleAt":0,"isProxyPost":false,"proxyPostFaviconUrl":"","proxyPostProviderName":"","proxyPostType":0,"isSuspended":false,"isLimitedState":false,"seoTitle":"","previewContent2":{"bodyModel":{"paragraphs":[{"name":"43e9","type":3,"text":"Dart declaration-site variance","markups":[]},{"name":"73f4","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"0*XcEdm2vmIBW8Wovr","originalWidth":1040,"originalHeight":502,"isFeatured":true,"alt":"A code snippet showing the contravariant variance modifier (`in`) in use."}},{"name":"502f","type":1,"text":"Declaration-site variance was my internship project on the Dart team, and I’ve documented my personal experience on the team in the article Life as a Dart intern. As the primary implementer of the declaration-site variance feature, I want to share the usages and benefits of sound variance.","markups":[{"type":3,"start":140,"end":161,"href":"https://medium.com/dartlang/life-as-a-dart-intern-a62cb8db2414","title":"","rel":"","anchorType":0},{"type":3,"start":197,"end":230,"href":"https://github.com/dart-lang/language/issues/524","title":"","rel":"","anchorType":0}]},{"name":"bf7b","type":1,"text":"We’ll discuss how…","markups":[]}],"sections":[{"name":"b3cf","startIndex":0}]},"isFullContent":false,"subtitle":"A deep dive into an experimental feature"},"cardType":0,"isDistributionAlertDismissed":false,"isShortform":false,"shortformType":0,"responsesLocked":false,"isLockedResponse":false,"isPublishToEmail":false,"responseDistribution":0,"isMarkedPaywallOnly":false,"type":"Post"},"mentionedUsers":[],"collaborators":[{"user":{"userId":"9e0692285f8b","name":"Bob Nystrom","username":"munificentbob","createdAt":1470154715067,"imageId":"0*F3n6Gi_e0RL-D9dg.","backgroundImageId":"","bio":"","twitterScreenName":"","allowNotes":1,"mediumMemberAt":0,"isWriterProgramEnrolled":true,"isSuspended":false,"isMembershipTrialEligible":true,"facebookDisplayName":"","optInToIceland":true,"hasCompletedProfile":false,"userDismissableFlags":[2,53,56,58],"hasSeenIcelandOnboarding":false,"postSubscribeMembershipUpsellShownAt":0,"languageCode":"en-us","type":"User"},"state":"visible"}],"hideMeter":false,"shareKey":"75c56eab3b08205241d88b3d96cd9e8d","collectionUserRelations":[{"collectionId":"23738d481ce8","userId":"8b6a7f6f197d","role":"ADMIN"},{"collectionId":"4da7dfd21a33","userId":"8b6a7f6f197d","role":"WRITER"},{"collectionId":"24d8f4fa8912","userId":"8b6a7f6f197d","role":"WRITER"}],"mode":"canEdit","references":{"User":{"5349d10e4a3b":{"userId":"5349d10e4a3b","name":"Kallen Tu","username":"kallentu","createdAt":1574211120913,"imageId":"0*mvkW6GAjihKjApCG","backgroundImageId":"","bio":"Software Engineer on the Dart team @ Google.","twitterScreenName":"","socialStats":{"userId":"5349d10e4a3b","usersFollowedCount":4,"usersFollowedByCount":98,"type":"SocialStats"},"social":{"userId":"8b6a7f6f197d","targetUserId":"5349d10e4a3b","type":"Social"},"allowNotes":1,"mediumMemberAt":0,"isWriterProgramEnrolled":true,"isSuspended":false,"isMembershipTrialEligible":true,"facebookDisplayName":"","optInToIceland":true,"hasCompletedProfile":false,"userDismissableFlags":[1,2,5,8,12,58],"hasSeenIcelandOnboarding":false,"postSubscribeMembershipUpsellShownAt":0,"languageCode":"en-us","type":"User"}},"Collection":{"23738d481ce8":{"id":"23738d481ce8","name":"Dart","slug":"dartlang","tags":["MOBILE APP DEVELOPMENT","WEB DEVELOPMENT","DART","PROGRAMMING LANGUAGES","SOFTWARE DEVELOPMENT"],"creatorId":"a6d788faa5e5","description":"Dart is an approachable, portable, and productive language for high-quality apps on any platform. Learn more at https://dart.dev.","shortDescription":"Dart is an approachable, portable, and productive language…","image":{"imageId":"1*uWy1Ajpd0oTUQBO9WBHoQg@2x.png","filter":"","backgroundSize":"","originalWidth":1001,"originalHeight":1001,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":14031,"activeAt":1762974121956},"virtuals":{"permissions":{"canPublish":true,"canPublishAll":true,"canRepublish":true,"canRemove":true,"canManageAll":true,"canSubmit":true,"canEditPosts":true,"canAddWriters":true,"canViewStats":true,"canSendNewsletter":true,"canViewLockedPosts":true,"canViewCloaked":true,"canEditOwnPosts":true,"canBeAssignedAuthor":true,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false,"canLockOwnPostsForMediumMembers":false,"canViewNewsletterV2Stats":true,"canCreateNewsletterV3":true},"isSubscribed":true,"isEnrolledInHightower":false,"isEligibleForHightower":false,"isSubscribedToCollectionEmails":false,"isMuted":false,"canToggleEmail":false,"isWriter":false},"logo":{"imageId":"1*NRb7RFVWJQFzY47j3v4U7Q.png","filter":"","backgroundSize":"","originalWidth":400,"originalHeight":154,"strategy":"resample","height":0,"width":0},"twitterUsername":"dart_lang","publicEmail":"medium@dartlang.org","domain":"blog.dart.dev","sections":[{"type":2,"collectionHeaderMetadata":{"title":"Dart","description":"An approachable, portable, and productive language for high-quality apps on any platform","backgroundImage":{},"logoImage":{"id":"1*knHF_qpxdtS8h0Z8EeqowA@2x.png","originalWidth":1080,"originalHeight":1080,"alt":"Dart"},"alignment":2,"layout":5}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":7,"postIds":[]}},{"type":1,"postListMetadata":{"source":1,"layout":5,"number":15,"postIds":[]}}],"tintColor":"#FF042B59","lightText":true,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF6588BA","point":0},{"color":"#FF607EAB","point":0.1},{"color":"#FF59759C","point":0.2},{"color":"#FF536B8E","point":0.3},{"color":"#FF4C617F","point":0.4},{"color":"#FF445670","point":0.5},{"color":"#FF3D4B61","point":0.6},{"color":"#FF344052","point":0.7},{"color":"#FF2B3442","point":0.8},{"color":"#FF212832","point":0.9},{"color":"#FF161A22","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FF042B59","point":0},{"color":"#FF294871","point":0.1},{"color":"#FF456087","point":0.2},{"color":"#FF5F779B","point":0.3},{"color":"#FF788DAD","point":0.4},{"color":"#FF8FA2BF","point":0.5},{"color":"#FFA5B6CF","point":0.6},{"color":"#FFBBC9DF","point":0.7},{"color":"#FFD1DCEE","point":0.8},{"color":"#FFE6EEFC","point":0.9},{"color":"#FFFBFFFF","point":1}],"backgroundColor":"#FF042B59"},"highlightSpectrum":{"colorPoints":[{"color":"#FFECF3FF","point":0},{"color":"#FFE9F2FF","point":0.1},{"color":"#FFE5F0FF","point":0.2},{"color":"#FFE2EFFF","point":0.3},{"color":"#FFDEEDFF","point":0.4},{"color":"#FFDBEBFF","point":0.5},{"color":"#FFD7EAFF","point":0.6},{"color":"#FFD3E8FF","point":0.7},{"color":"#FFCFE6FF","point":0.8},{"color":"#FFCBE5FF","point":0.9},{"color":"#FFC8E3FF","point":1}],"backgroundColor":"#FFFFFFFF"},"darkBackgroundSpectrum":{"colorPoints":[{"color":"#FF7DA0D3","point":0},{"color":"#FF89A9D8","point":0.1},{"color":"#FF94B1DC","point":0.2},{"color":"#FFA0B9E0","point":0.3},{"color":"#FFABC1E3","point":0.4},{"color":"#FFB6C9E7","point":0.5},{"color":"#FFC0D1EB","point":0.6},{"color":"#FFCBD8EF","point":0.7},{"color":"#FFD5E0F2","point":0.8},{"color":"#FFE0E7F6","point":0.9},{"color":"#FFEAEFFA","point":1}],"backgroundColor":"#FF000000"}},"navItems":[{"type":1,"title":"Announcements","tagSlug":"announcements","url":"https://blog.dart.dev/tagged/announcements","source":"tagSlug"},{"type":5,"title":"Archive","url":"https://blog.dart.dev/archive"},{"type":3,"title":"dart.dev","url":"https://dart.dev"}],"colorBehavior":2,"collectionFeatures":[25],"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"Dart","description":"An approachable, portable, and productive language for high-quality apps on any platform","backgroundImage":{},"logoImage":{"id":"1*knHF_qpxdtS8h0Z8EeqowA@2x.png","originalWidth":1080,"originalHeight":1080,"alt":"Dart"},"alignment":2,"layout":5},"subscriberCount":14031,"tagline":"Dart is a client-optimized language for fast apps on any platform.","isOptedIntoAurora":false,"isCurationAllowedByDefault":false,"polarisCoverImage":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"ptsQualifiedAt":1616092887098,"type":"Collection"}},"Social":{"5349d10e4a3b":{"userId":"8b6a7f6f197d","targetUserId":"5349d10e4a3b","type":"Social"}},"SocialStats":{"5349d10e4a3b":{"userId":"5349d10e4a3b","usersFollowedCount":4,"usersFollowedByCount":98,"type":"SocialStats"}}}},"v":3,"b":"20260130-1012-root"}